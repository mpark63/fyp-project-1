<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Four Year Planner</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="style.css" />
    <script src="script.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css"/>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  </head>
  <body>
    <!-- NAV BAR -->
    <nav class="navbar is-fixed-top" aria-label="main navigation">
      <div class="navbar-brand">
        <h3 class="title is-3 fyp">Four Year Plan</h3>
      </div>
      <div class="field is-grouped">
        <!-- SEARCH BAR AND RESULTS -->
        <form>
          <div class="form-group">
            <p class="control is-expanded" id="searchbar">
              <input
                class="input"
                id="txt-search"
                type="text"
                placeholder="Search for a course..."
                value=""
              />
            </p>
            <div id="filter-records"></div>
          </div>
        </form>
      </div>
      <!-- LOGIN AND SAVE BUTTONS -->
      <div style="margin-top: 8px">
        <button class="button is-info">Log in</button>
        <button class="button is-info" onclick="download()">Download</button>
      </div>
    </nav>
    <!-- SEMESTERS CONTAINER -->
    <div class="container" id="container">
      <br /><br /><br />
      <!-- FRESHMAN COLUMNS -->
      <div class="columns is-vcentered">
        <div class="column">
          <h4 class="title is-4">Freshman</h4>
          <h5 class="subtitle is-5">Fall</h5>
          <!-- COURSES CONTAINER FOR FALL -->
          <div
            class="card sem"
            id="s1"
            ondrop="drop(event)"
            ondragover="allowDrop(event)"
          >
            <div>
              <div
                class="card drag"
                id="EN.500.112"
                draggable="true"
                ondragstart="drag(event)"
                style="background-color: #2374c7; color: white"
              >
                <button
                  class="delete is-small"
                  id="dEN500112"
                  onclick="deleteCourse('EN.500.112');"
                ></button>
                <div class="card-content">
                  EN.500.112<br />
                  Gateway Computing: JAVA (3.00)
                </div>
              </div>
              <div
                class="card drag"
                id="EN.601.104"
                draggable="true"
                ondragstart="drag(event)"
                style="background-color: #2374c7; color: white"
              >
                <button
                  class="delete is-small"
                  id="dEN601104"
                  onclick="deleteCourse('EN.601.104');"
                ></button>
                <div class="card-content">
                  EN.601.104<br />
                  Computer Ethics (1.00)
                </div>
              </div>
            </div>
            <footer class="card-footer card-footer-padding">
              <p class="credits" id="cs1">4 credits</p>
            </footer>
          </div>
          <br />
          <!-- COURSES CONTAINER FOR SPRING -->
          <h5 class="subtitle is-5">Spring</h5>
          <div
            class="card sem"
            id="s2"
            ondrop="drop(event)"
            ondragover="allowDrop(event)"
          >
            <div>
              <div
                class="card drag"
                id="EN.601.220"
                draggable="true"
                ondragstart="drag(event)"
                style="background-color: #2374c7; color: white"
              >
                <button
                  class="delete is-small"
                  id="dEN601220"
                  onclick="deleteCourse('EN.601.220');"
                ></button>
                <div class="card-content">
                  EN.601.220<br />
                  Intermediate Programming (4.00)
                </div>
              </div>
            </div>
            <footer class="card-footer card-footer-padding">
              <p class="credits" id="cs2">4 credits</p>
            </footer>
          </div>
        </div>
        <!-- SOPHOMORE COLUMNS -->
        <div class="column">
          <h4 class="title is-4">Sophomore</h4>
          <!-- COURSES CONTAINER FOR FALL -->
          <h5 class="subtitle is-5">Fall</h5>
          <div
            class="card sem"
            id="s3"
            ondrop="drop(event)"
            ondragover="allowDrop(event)"
          >
            <div>
              <div
                class="card drag"
                id="EN.601.226"
                draggable="true"
                ondragstart="drag(event)"
                style="background-color: #2374c7; color: white"
              >
                <button
                  class="delete is-small"
                  id="dEN601226"
                  onclick="deleteCourse('EN.601.226');"
                ></button>
                <div class="card-content">
                  EN.601.226<br />
                  Data Structures (4.00)
                </div>
              </div>
              <div
                class="card drag"
                id="EN.601.229"
                draggable="true"
                ondragstart="drag(event)"
                style="background-color: #2374c7; color: white"
              >
                <button
                  class="delete is-small"
                  id="dEN601229"
                  onclick="deleteCourse('EN.601.229');"
                ></button>
                <div class="card-content">
                  EN.601.229<br />
                  Computer System Fundamentals (3.00)
                </div>
              </div>
            </div>
            <footer class="card-footer card-footer-padding">
              <p class="credits" id="cs3">7 credits</p>
            </footer>
          </div>
          <br />
          <!-- COURSES CONTAINER FOR SPRING -->
          <h5 class="subtitle is-5">Spring</h5>
          <div
            class="card sem"
            id="s4"
            ondrop="drop(event)"
            ondragover="allowDrop(event)"
          >
            <div>
              <div
                class="card drag"
                id="EN.601.230"
                draggable="true"
                ondragstart="drag(event)"
                style="background-color: #2374c7; color: white"
              >
                <button
                  class="delete is-small"
                  id="dEN601230"
                  onclick="deleteCourse('EN.601.230');"
                ></button>
                <div class="card-content">
                  EN.601.230<br />
                  Mathematical Foundations for CS (4.00)
                </div>
              </div>
            </div>
            <footer class="card-footer card-footer-padding">
              <p class="credits" id="cs4">4 credits</p>
            </footer>
          </div>
        </div>
        <!-- JUNIOR COLUMNS -->
        <div class="column">
          <h4 class="title is-4">Junior</h4>
          <!-- COURSES CONTAINER FOR FALL -->
          <h5 class="subtitle is-5">Fall</h5>
          <div
            class="card sem"
            id="s5"
            ondrop="drop(event)"
            ondragover="allowDrop(event)"
          >
            <div>
              <div
                class="card drag"
                id="EN.601.433"
                draggable="true"
                ondragstart="drag(event)"
                style="background-color: #2374c7; color: white"
              >
                <button
                  class="delete is-small"
                  id="dEN601433"
                  onclick="deleteCourse('EN.601.433');"
                ></button>
                <div class="card-content">
                  EN.601.433<br />
                  Intro to Algorithms (3.00)
                </div>
              </div>
            </div>
            <footer class="card-footer card-footer-padding">
              <p class="credits" id="cs5">3 credits</p>
            </footer>
          </div>
          <br />
          <!-- COURSES CONTAINER FOR SPRING -->
          <h5 class="subtitle is-5">Spring</h5>
          <div
            class="card sem"
            id="s6"
            ondrop="drop(event)"
            ondragover="allowDrop(event)"
          >
            <div></div>
            <footer class="card-footer card-footer-padding">
              <p class="credits" id="cs6">0 credits</p>
            </footer>
          </div>
        </div>
        <!-- SENIOR COLUMNS -->
        <div class="column">
          <h4 class="title is-4">Senior</h4>
          <!-- COURSES CONTAINER FOR FALL -->
          <h5 class="subtitle is-5">Fall</h5>
          <div
            class="card sem"
            id="s7"
            ondrop="drop(event)"
            ondragover="allowDrop(event)"
          >
            <div></div>
            <footer class="card-footer card-footer-padding">
              <p class="credits" id="cs7">0 credits</p>
            </footer>
          </div>
          <br />
          <!-- COURSES CONTAINER FOR SPRING -->
          <h5 class="subtitle is-5">Spring</h5>
          <div
            class="card sem"
            id="s8"
            ondrop="drop(event)"
            ondragover="allowDrop(event)"
          >
            <div></div>
            <footer class="card-footer card-footer-padding">
              <p class="credits" id="cs8">0 credits</p>
            </footer>
          </div>
        </div>
      </div>
      <!-- WHAT IF BUTTON -->
      <button class="button is-info" style="float: right" onclick="getDegreeProgress()">
        <strong>What If?</strong>
      </button>
      <!-- TOTAL CREDITS COUNT -->
      <h4
        class="title is-4"
        id="total"
        style="float: right; padding: 5px; padding-right: 10px"
      >
        22.0 credits
      </h4>
      <br /><br /><br />
    <!-- SUGGESTIONS CONTAINER -->
    </div>
    <h4 class="title is-4" style="margin-left: 40%">
      Courses Suggested For You
    </h4>
    <div class="card" style="width: 450px; margin-left: 35%">
      <div id="suggestion">
        <div
          class="card drag"
          id="EN.601.270"
          draggable="true"
          ondragstart="drag(event)"
        >
          <button
            class="delete is-small"
            id="dEN601270"
            onclick="deleteCourse('EN.601.270');"
          ></button>
          <div class="card-content">
            EN.601.270<br />
            Full Stack Javascript (3.00)
          </div>
        </div>
        <div
          class="card drag"
          id="EN.601.290"
          draggable="true"
          ondragstart="drag(event)"
        >
          <button
            class="delete is-small"
            id="dEN601290"
            onclick="deleteCourse('EN.601.290');"
          ></button>
          <div class="card-content">
            EN.601.290<br />
            User Interfaces & Mobile Apps (3.00)
          </div>
        </div>
        <div
          class="card drag"
          id="EN.601.318"
          draggable="true"
          ondragstart="drag(event)"
        >
          <button
            class="delete is-small"
            id="dEN601318"
            onclick="deleteCourse('EN.601.318');"
          ></button>
          <div class="card-content">
            EN.601.318<br />
            Operating Systems (3.00)
          </div>
        </div>
        <div
          class="card drag"
          id="EN.553.311"
          draggable="true"
          ondragstart="drag(event)"
        >
          <button
            class="delete is-small"
            id="dEN553311"
            onclick="deleteCourse('EN.553.311');"
          ></button>
          <div class="card-content">
            EN.553.311<br />
            Prob & Stat for Physical / engineering (4.00)
          </div>
        </div>
        <div
          class="card drag"
          id="EN.601.421"
          draggable="true"
          ondragstart="drag(event)"
        >
          <button
            class="delete is-small"
            id="dEN601421"
            onclick="deleteCourse('EN.601.421');"
          ></button>
          <div class="card-content">
            EN.601.421<br />
            Object Oriented Software Engineering (3.00)
          </div>
        </div>
        <div
          class="card drag"
          id="AS.110.201"
          draggable="true"
          ondragstart="drag(event)"
        >
          <button
            class="delete is-small"
            id="dAS110201"
            onclick="deleteCourse('AS.110.201');"
          ></button>
          <div class="card-content">
            AS.110.201<br />
            Linear Algebra (4.00)
          </div>
        </div>
        <div
          class="card drag"
          id="EN.601.482"
          draggable="true"
          ondragstart="drag(event)"
        >
          <button
            class="delete is-small"
            id="dEN601482"
            onclick="deleteCourse('EN.601.482');"
          ></button>
          <div class="card-content">
            EN.601.482<br />
            Machine Learning: Deep Learning (3.00)
          </div>
        </div>
      </div>
    </div>

    <!-- SCRIPT FOR DISPLAYING SEARCH RESULTS -->
    <script>
      // array of all courses
      // each course has the code, title, area, and credits
      data = [];
      // request for School of Engineering classes
      fetch(
        "https://murmuring-eyrie-98570.herokuapp.com/https://sis.jhu.edu/api/classes?key=JjHPAfkaB7SZpfX6MnQIXXHMGARAHR8x&School=Whiting%20School%20of%20Engineering&Term=Fall%202021&Term=Spring%202021"
      )
        .then((response) => response.json()) // convert string to json
        .then((courses) => {
          courses.forEach((course) => {
            if (course["SectionName"] == "01") {
              // consider one section per course
              courseDict = {};
              courseDict.code = course.OfferingName;
              courseDict.title = course.Title;
              courseDict.areas = course.Areas;
              courseDict.credits = course.Credits;
              data.push(courseDict); // add to data arary
            }
          });
        });
      // request for School of Arts and Sciences classes
      fetch(
        "https://murmuring-eyrie-98570.herokuapp.com/https://sis.jhu.edu/api/classes?key=JjHPAfkaB7SZpfX6MnQIXXHMGARAHR8x&School=Krieger%20School%20of%20Arts%20and%20Sciences&Term=Fall%202021&Term=Spring%202021"
      )
        .then((response) => response.json()) // convert string to json
        .then((courses) => {
          courses.forEach((course) => {
            if (course["SectionName"] == "01") {
              // consider one section per course
              courseDict = {};
              courseDict.code = course.OfferingName;
              courseDict.title = course.Title;
              courseDict.areas = course.Areas;
              courseDict.credits = course.Credits;
              data.push(courseDict); // add to data arary
            }
          });
        });
      // keyup event listener for search bar
      $("#txt-search").keyup(function () {
        var searchField = $(this).val();
        if (searchField === "") {
          // if no search, show no courses
          $("#filter-records").html("");
          return;
        }
        // match text to search field, with ignoreCase flag
        var regex = new RegExp(searchField, "i");
        // populate dropdown element with matching courses
        var dropdown = `<div class="row" id="dropdown-menu">`;
        $.each(data, function (key, val) {
          if (val.code.search(regex) != -1 || val.title.search(regex) != -1) {
            dropdown +=
              '<a class="dropdown-item" onclick="addCourse(' + 0 + ",'" + val.code + "','" + val.title + "','" + val.credits + "','" + val.areas + "');\">";
            dropdown += `${val.code}:  ${val.title} (${val.credits})`;
            dropdown += "</a>";
          }
        });
        dropdown += "</div>";
        // add dropdown element to filter-records
        $("#filter-records").html(dropdown);
      });
    </script>
  </body>
</html>
